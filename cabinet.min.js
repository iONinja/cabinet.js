Object.defineProperty(Object.prototype,"watch",{enumerable:!1,configurable:!0,writable:!1,value:function(a,b){var c=this[a],d=c;delete this[a]&&Object.defineProperty(this,a,{get:function(){return d},set:function(h){return c=d,d=b.call(this,a,c,h)},enumerable:!0,configurable:!0})}}),Object.defineProperty(Object.prototype,"unwatch",{enumerable:!1,configurable:!0,writable:!1,value:function(a){var b=this[a];delete this[a],this[a]=b}});var _node="undefined"!=typeof module&&module.exports;if(_node){var path=require("path"),LocalStorage=require("node-localstorage").LocalStorage;localStorage=new LocalStorage(path.join(path.dirname(module.parent.filename),"cabinet"))}cabinet={_load:function(){_node?this.node={new:!0}:(this.site={new:!0},this.page={new:!0});var a=localStorage.getItem("cabinet");if(null!=a){var b=JSON.parse(a);this._variables=b.variables,this._globals=b.globals,this._pages=b.pages,_node?this.node.new=!1:this.site.new=!1}else this._save();this._path=_node?"/":window.location.pathname,0>this._pages.indexOf(this._path)?(this._pages.push(this._path),this._variables[this._path]={}):!_node&&(this.page.new=!1)},_save:function(){localStorage.setItem("cabinet",JSON.stringify({pages:this._pages,variables:this._variables,globals:this._globals}))},_variables:{},_globals:{},_pages:[],_path:"/",site:null,page:null,node:null,sync:function(){var a=null;a=!0==arguments[arguments.length-1]?this._globals:this._variables[this._path];for(var c,b=0;b<arguments.length;b++){if(c=arguments[b],c){var d;d=_node?global:window,void 0==a[c]?a[c]=d[c]:d[c]=a[c]}this._save(),d.watch(c,function(e,f,h,j){return f in e&&(e[f]=j,this._save()),j}.bind(this,a))}},wipe:function(){this._variables={},this._globals={},this.site.new=!0,this.page.new=!0,localStorage.removeItem("cabinet")}},cabinet._load(),_node&&(module.exports=cabinet);
